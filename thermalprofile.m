function [upwardvelocity,point] = thermalprofile(center_velocity,radius,a,b)% This function creates a polar matrix plotting a velocity surface for a% thermal based on its inner strength, outer strength, radius, and the% order to get a proper profile%   The code uses a cosine profile to approximate the bell-curve profile of the%   surface. % Inputs are as follows: center upward velocity, thermal radius,% xpoint, ypoint % Outputs are as follows: upward velocity matrix, upward velocity at the given point x = linspace(-radius,radius,1000) ;y = linspace(-radius,radius,1000) ;for i = 1:length(x)    for j = 1:length(y)               r(i,j) = sqrt((x(i)^2) + (y(j)^2)) ;              upwardvelocity(i,j) =  ((center_velocity) * cos( ((r(i,j))/(2*radius)) * pi)) ;           end    end% for an single pointr = sqrt((x(a)^2) + (y(b)^2)) ;    point = ((center_velocity/2) * cos(((r)/radius) * pi)) + (center_velocity/2) ;end